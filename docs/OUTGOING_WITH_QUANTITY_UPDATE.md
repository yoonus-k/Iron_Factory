# ๐ค ุชุญุฏูุซ: ุงูุฅุฎุฑุงุฌ ูู ุงููุณุชูุฏุน ุจุงููููุฉ

## โ ูุง ุชู ุชุญุฏูุซู

### 1๏ธโฃ Model: MaterialDetail.php

#### ุงูุฏุงูุฉ ุงููุญุณููุฉ: `reduceOutgoingQuantity()`

```php
public function reduceOutgoingQuantity(float $quantity, ?float $weight = null): void
```

**ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ:**
- โ **ุฎุตู ุงููููุฉ ุฅุฌุจุงุฑู** - ูุฌุจ ุชุญุฏูุฏ ุงููููุฉ ุงููุฑุงุฏ ุฅุฎุฑุงุฌูุง
- โ **ุงูุชุญูู ูู ุงููููุฉ ุงููุชููุฑุฉ** - ูููุน ุงูุฅุฎุฑุงุฌ ุฅุฐุง ูุงูุช ุงููููุฉ ุบูุฑ ูุงููุฉ
- โ **ุฎุตู ุงููุฒู ุชููุงุฆูุงู** - ุฅุฐุง ูู ููุญุฏุฏ ุงููุฒูุ ูุชู ุญุณุงุจู ุจูุงุกู ุนูู ุงููุณุจุฉ
- โ **ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ** - ุชุนุฑุถ ุงููููุฉ ุงููุทููุจุฉ ูุงููุชููุฑุฉ
- โ **ุชุณุฌูู ูู Log** - ูู ุนูููุฉ ุฎุตู ุชูุณุฌู ูู logs

**ูุซุงู ุงูุงุณุชุฎุฏุงู:**
```php
// ุฎุตู 100 ูุญุฏุฉ ููุท (ุงููุฒู ููุญุณุจ ุชููุงุฆูุงู)
$materialDetail->reduceOutgoingQuantity(100);

// ุฎุตู 100 ูุญุฏุฉ ูุน ูุฒู ูุญุฏุฏ 500 ูุฌู
$materialDetail->reduceOutgoingQuantity(100, 500);
```

---

### 2๏ธโฃ Controller: DeliveryNoteController.php

#### Validation ููุฅุฐู ุงูุตุงุฏุฑ:
```php
'material_detail_id' => $type === 'outgoing' ? 'required|exists:material_details,id' : 'nullable',
'delivery_quantity' => $type === 'outgoing' ? 'required|numeric|min:0.01' : 'nullable',
```

**ูุง ูุนูู:**
- โ ุงููุงุฏุฉ **ุฅุฌุจุงุฑูุฉ** ููุฃุฐู ุงูุตุงุฏุฑ
- โ ุงููููุฉ **ุฅุฌุจุงุฑูุฉ** ููุฃุฐู ุงูุตุงุฏุฑ (ุฃูุจุฑ ูู ุตูุฑ)
- โ ุงููุงุฏุฉ ูุงููููุฉ **ุงุฎุชูุงุฑูุฉ** ููุฃุฐู ุงููุงุฑุฏ (ูุชู ุฅุฏุฎุงููุง ูู ุงูุชุณุฌูู)

#### ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ:
```php
elseif ($type === 'outgoing') {
    $materialDetail->reduceOutgoingQuantity(
        $validated['delivery_quantity'],
        $validated['actual_weight'] ?? null
    );
}
```

**ุฑุณุงุฆู ุงูุฎุทุฃ:**
- โ "ูุฌุจ ุงุฎุชูุงุฑ ุงููุงุฏุฉ ููุฃุฐู ุงูุตุงุฏุฑุฉ"
- โ "ุงููููุฉ ูุทููุจุฉ ููุฃุฐู ุงูุตุงุฏุฑุฉ"
- โ "ุงููููุฉ ูุฌุจ ุฃู ุชููู ุฃูุจุฑ ูู ุตูุฑ"

---

### 3๏ธโฃ View: create.blade.php

#### ุงูุญููู ุงูุฌุฏูุฏุฉ ููุฅุฐู ุงูุตุงุฏุฑ:

**1. ุงุฎุชูุงุฑ ุงููุงุฏุฉ:**
```html
<select name="material_detail_id" id="material_detail_id_outgoing">
    <option>ุงููุงุฏุฉ - ุงููุณุชูุฏุน (ูุชููุฑ: 100 ูุญุฏุฉ)</option>
</select>
```

**2. ุฅุฏุฎุงู ุงููููุฉ:**
```html
<input type="number" name="delivery_quantity" id="delivery_quantity_outgoing" 
       min="0.01" step="0.01" required>
```

**3. ุนุฑุถ ุงููููุฉ ุงููุชููุฑุฉ:**
- โ ูุนุฑุถ ุงููููุฉ ุงููุชููุฑุฉ ุนูุฏ ุงุฎุชูุงุฑ ุงููุงุฏุฉ
- โ๏ธ ุชุญุฐูุฑ ุฅุฐุง ุชุฌุงูุฒุช ุงููููุฉ ุงููุทููุจุฉ
- โ ููุน ุงูุญูุธ ุฅุฐุง ูุงูุช ุงููููุฉ ุบูุฑ ูุงููุฉ

#### JavaScript ููุชุญูู:
```javascript
// ุนุฑุถ ุงููููุฉ ุงููุชููุฑุฉ
materialDetailOutgoing.addEventListener('change', function() {
    const availableQty = selectedOption.getAttribute('data-quantity');
    availableDisplay.textContent = `โ ุงููููุฉ ุงููุชููุฑุฉ: ${availableQty}`;
});

// ุงูุชุญูู ูู ุงููููุฉ ุนูุฏ ุงูุฅุฏุฎุงู
quantityOutgoing.addEventListener('input', function() {
    if (currentQty > maxQty) {
        alert('โ ุงููููุฉ ุฃูุจุฑ ูู ุงููุชููุฑ');
    }
});

// ููุน ุงูุญูุธ ุฅุฐุง ูุงูุช ุงููููุฉ ุฎุงุทุฆุฉ
form.addEventListener('submit', function(e) {
    if (currentQty > maxQty) {
        e.preventDefault();
        alert('โ ุงููููุฉ ุงููุทููุจุฉ ุฃูุจุฑ ูู ุงููุชููุฑุฉ');
    }
});
```

---

## ๐ฏ ุณููุงุฑูู ุงูุงุณุชุฎุฏุงู ุงููุงูู

### ุฎุทูุงุช ุฅูุดุงุก ุฃุฐู ุตุงุฏุฑ:

1๏ธโฃ **ุงุฐูุจ ุฅูู:** ุงููุณุชูุฏุน > ุฃุฐูู ุงูุชุณููู > ุฅุถุงูุฉ ุฌุฏูุฏ

2๏ธโฃ **ุงุฎุชุฑ ุงูููุน:** ๐ผ ุฃุฐู ุตุงุฏุฑุฉ

3๏ธโฃ **ุงุฎุชุฑ ุงููุงุฏุฉ:** ุญุฏูุฏ - ุงููุณุชูุฏุน ุงูุฑุฆูุณู (ูุชููุฑ: 1000 ุทู)

4๏ธโฃ **ุฃุฏุฎู ุงููููุฉ:** 500 ุทู
   - โ ูุนุฑุถ: "ุณูุชู ุฎุตู 500 ุทู ูู ุงููุณุชูุฏุน"

5๏ธโฃ **ุงุฎุชุฑ ุงููุฌูุฉ:** ูุณู ุงูุฅูุชุงุฌ

6๏ธโฃ **ุงูุชุจ ุงูุณุจุจ:** "ููุฅูุชุงุฌ - ุทูุจูุฉ ุฑูู 123"

7๏ธโฃ **ุงุญูุธ**

### ูุง ูุญุฏุซ ุนูุฏ ุงูุญูุธ:

```text
โ ุฅูุดุงุก ุฃุฐู ุตุงุฏุฑ ูู delivery_notes
โ ุชุณุฌูู ุญุฑูุฉ ูู material_movements (outgoing)
โ ุฎุตู 500 ุทู ูู material_details
   - ุงููููุฉ: 1000 โ 500 ุทู
   - ุงููุฒู: ููุญุณุจ ุชููุงุฆูุงู ุจุงููุณุจุฉ
โ ุชุณุฌูู ูู operation_logs
โ ุชุณุฌูู ูู Log: "ุชู ุฎุตู ูููุฉ ูู ุงููุณุชูุฏุน"
```

---

## โ๏ธ ุงูุชุญููุงุช ูุงูุญูุงูุฉ

### 1. ูู ุงููุงุฌูุฉ (View):
- โ ูุง ูููู ุฅุฏุฎุงู ูููุฉ ุฃูุจุฑ ูู ุงููุชููุฑ
- โ ุฑุณุงูุฉ ุชุญุฐูุฑ ููุฑูุฉ
- โ ููุน ุงูุญูุธ ูุจู ุงูุชุตุญูุญ

### 2. ูู ุงูู Validation:
- โ ุงููุงุฏุฉ ูุงููููุฉ ุฅุฌุจุงุฑูุฉ
- โ ุงููููุฉ ูุฌุจ ุฃู ุชููู > 0
- โ ุงููุงุฏุฉ ูุฌุจ ุฃู ุชููู ููุฌูุฏุฉ

### 3. ูู ุงูู Model:
- โ ุงูุชุญูู ูู ุงููููุฉ ุงููุชููุฑุฉ
- โ ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ: "ุงููุทููุจ: 600 | ุงููุชููุฑ: 500"
- โ ููุน ุงูุฎุตู ุฅุฐุง ูุงูุช ุงููููุฉ ุบูุฑ ูุงููุฉ

### 4. ูู ุงูู Database:
- โ Transaction - ุฅุฐุง ูุดู ุงูุฎุตูุ ูููุบู ุงูุฃุฐู
- โ Rollback ุชููุงุฆู ุนูุฏ ุงูุฎุทุฃ

---

## ๐ ุฑุณุงุฆู ุงููุฌุงุญ ูุงูุฎุทุฃ

### ุฑุณุงุฆู ุงููุฌุงุญ:
```
โ ุชู ุฅุถุงูุฉ ุฃุฐู ุงูุชุณููู ุงูุตุงุฏุฑุฉ ุจูุฌุงุญ - ุฑูู ุงูุฃุฐู: DN-2025-001
โ ุชู ุชุณุฌูููุง ูู ุณุฌู ุงูุนูููุงุช
โ ุณูุชู ุฎุตู 500 ุทู ูู ุงููุณุชูุฏุน
```

### ุฑุณุงุฆู ุงูุฎุทุฃ:
```
โ ูุฌุจ ุงุฎุชูุงุฑ ุงููุงุฏุฉ ููุฃุฐู ุงูุตุงุฏุฑุฉ
โ ุงููููุฉ ูุทููุจุฉ ููุฃุฐู ุงูุตุงุฏุฑุฉ
โ ุงููููุฉ ูุฌุจ ุฃู ุชููู ุฃูุจุฑ ูู ุตูุฑ
โ ุงููููุฉ ุงููุชุงุญุฉ ุบูุฑ ูุงููุฉ. ุงููุทููุจ: 600 ุทู | ุงููุชููุฑ: 500 ุทู
โ ูุดู ุชุญุฏูุซ ุงููุณุชูุฏุน: [ุชูุงุตูู ุงูุฎุทุฃ]
```

---

## ๐ ููุฎุต ุงูุชุญุฏูุซุงุช

| ุงูููู | ุงูุชุญุฏูุซ | ุงูุญุงูุฉ |
|-------|---------|--------|
| MaterialDetail.php | ุชุญุณูู `reduceOutgoingQuantity()` | โ ููุชูู |
| DeliveryNoteController.php | Validation ูููููุฉ | โ ููุชูู |
| create.blade.php | ุญููู ุงููุงุฏุฉ ูุงููููุฉ | โ ููุชูู |
| create.blade.php | JavaScript ููุชุญูู | โ ููุชูู |

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

**ุงูุขู ูุธุงู ุงูุฅุฎุฑุงุฌ ูู ุงููุณุชูุฏุน:**
- โ ูุชุทูุจ ุงุฎุชูุงุฑ ุงููุงุฏุฉ
- โ ูุชุทูุจ ุฅุฏุฎุงู ุงููููุฉ
- โ ูุชุญูู ูู ุชููุฑ ุงููููุฉ
- โ ูุฎุตู ุงููููุฉ ูุงููุฒู ุชููุงุฆูุงู
- โ ูููุน ุงูุฅุฎุฑุงุฌ ุฅุฐุง ูุงูุช ุงููููุฉ ุบูุฑ ูุงููุฉ
- โ ูุณุฌู ูู ุดูุก ูู logs

**ุงููุธุงู ุฌุงูุฒ ููุนูู! ๐**
