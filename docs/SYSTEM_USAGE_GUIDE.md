# ๐ญ ูุธุงู ุงูุชุณุฌูู ูุงูุชุณููุฉ - ุฏููู ุงูุงุณุชุฎุฏุงู ุงููุงูู

## ๐ ูุญุชููุงุช ุงูุชูุซูู

1. [ุงูุจุฏุก ุงูุณุฑูุน](#ุงูุจุฏุก-ุงูุณุฑูุน)
2. [ุงููููุงุช ุงููููุดุฃุฉ](#ุงููููุงุช-ุงููููุดุฃุฉ)
3. [ุฏููู ุงูุงุณุชุฎุฏุงู](#ุฏููู-ุงูุงุณุชุฎุฏุงู)
4. [ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ](#ุงูููุฒุงุช-ุงูุฑุฆูุณูุฉ)
5. [ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ](#ุงูุฃุณุฆูุฉ-ุงูุดุงุฆุนุฉ)

---

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### 1. ุชุดุบูู ุงูู Migrations

```bash
# ุชุดุบูู ูู ุงูู migrations ุงูุฌุฏูุฏุฉ
php artisan migrate

# ุฃู ุชุดุบูู migration ูุนููุฉ
php artisan migrate --path=database/migrations/2025_11_17_000001_add_reconciliation_fields_to_delivery_notes.php
php artisan migrate --path=database/migrations/2025_11_17_000002_create_reconciliation_logs_table.php
php artisan migrate --path=database/migrations/2025_11_17_000003_create_registration_logs_table.php
```

### 2. ุงูุชุญูู ูู ุงููููุงุช

ุชุฃูุฏ ูู ูุฌูุฏ ูุฐู ุงููููุงุช:

```
โ app/Models/ReconciliationLog.php
โ app/Models/RegistrationLog.php
โ Modules/Manufacturing/Http/Controllers/WarehouseRegistrationController.php
โ Modules/Manufacturing/Http/Controllers/ReconciliationController.php
โ Modules/Manufacturing/resources/views/warehouses/registration/pending.blade.php
โ Modules/Manufacturing/resources/views/warehouses/registration/create.blade.php
โ Modules/Manufacturing/resources/views/warehouses/registration/show.blade.php
โ Modules/Manufacturing/resources/views/warehouses/reconciliation/index.blade.php
โ Modules/Manufacturing/resources/views/warehouses/reconciliation/show.blade.php
```

### 3. ุฅุถุงูุฉ ุงูุฑูุงุจุท ูู ุงูู Navigation

ูู ููู ุงูู sidebar ุฃู ุงูู navigationุ ุฃุถู:

```blade
<!-- ุงูุชุณุฌูู ูุงูุชุณููุฉ -->
<li class="nav-item">
    <a class="nav-link" href="{{ route('manufacturing.warehouse.registration.pending') }}">
        ๐ฆ ุชุณุฌูู ุงูุจุถุงุนุฉ
    </a>
</li>
<li class="nav-item">
    <a class="nav-link" href="{{ route('manufacturing.warehouses.reconciliation.index') }}">
        ๐ ุชุณููุฉ ุงูุจุถุงุนุฉ
    </a>
</li>
```

---

## ๐ ุงููููุงุช ุงููููุดุฃุฉ

### Database Migrations

| ุงูููู | ุงููุตู |
|--------|--------|
| `2025_11_17_000001_add_reconciliation_fields_to_delivery_notes.php` | ุฅุถุงูุฉ 14 ุญูู ุฌุฏูุฏ ูู delivery_notes |
| `2025_11_17_000002_create_reconciliation_logs_table.php` | ุฌุฏูู ุชุณุฌูู ุงูุชุณููุงุช |
| `2025_11_17_000003_create_registration_logs_table.php` | ุฌุฏูู ุชุณุฌูู ุนูููุฉ ุงูุชุณุฌูู |

### Models

| ุงูููู | ุงููุตู |
|--------|--------|
| `app/Models/ReconciliationLog.php` | Model ูุณุฌูุงุช ุงูุชุณููุฉ (ุฌุฏูุฏ) |
| `app/Models/RegistrationLog.php` | Model ูุณุฌูุงุช ุงูุชุณุฌูู (ุฌุฏูุฏ) |
| `app/Models/DeliveryNote.php` | ุชุญุฏูุซ ุจู 23 ุญูู ูุนูุงูุงุช ุฌุฏูุฏุฉ |
| `app/Models/PurchaseInvoice.php` | ุชุญุฏูุซ ุจู methods ุฌุฏูุฏุฉ |

### Controllers

| ุงูููู | ุงููุตู |
|--------|--------|
| `WarehouseRegistrationController.php` | 7 methods ูุชุณุฌูู ุงูุจุถุงุนุฉ |
| `ReconciliationController.php` | 6 methods ูุชุณููุฉ ุงูุจุถุงุนุฉ |

### Views

| ุงููุณุงุฑ | ุงููุตู |
|---------|--------|
| `registration/pending.blade.php` | ูุงุฆูุฉ ุงูุดุญูุงุช ุงููุนููุฉ ูุงููุณุฌูุฉ |
| `registration/create.blade.php` | ูููุฐุฌ ุชุณุฌูู ุดุญูุฉ ุฌุฏูุฏุฉ |
| `registration/show.blade.php` | ุนุฑุถ ุชูุงุตูู ุงูุชุณุฌูู |
| `reconciliation/index.blade.php` | ููุญุฉ ุงูุชุณููุฉ |
| `reconciliation/show.blade.php` | ููุญุฉ ุงูุชุณููุฉ ุงูุชูุตูููุฉ |

---

## ๐ ุฏููู ุงูุงุณุชุฎุฏุงู

### ๐ค ุฃููู ุงููุณุชูุฏุน (Warehouse Manager)

#### ุงูุฎุทูุฉ 1: ุนุฑุถ ุงูุดุญูุงุช ุงููุนููุฉ
```
ุงุฐูุจ ุฅูู: ๐ฆ ุชุณุฌูู ุงูุจุถุงุนุฉ
ุณุชุฌุฏ:
  - ุงูุดุญูุงุช ุงููุนููุฉ (ุจุงูุชุธุงุฑ ุงูุชุณุฌูู)
  - ุงูุดุญูุงุช ุงููุณุฌูุฉ ุจุงููุนู
```

#### ุงูุฎุทูุฉ 2: ุชุณุฌูู ุดุญูุฉ ุฌุฏูุฏุฉ
```
ุงุถุบุท ุนูู: ๐ ุชุณุฌูู
ุฃููุง ุงูุจูุงูุงุช:
  โ ุงููุฒู ุงููุนูู (ูู ุงูููุฒุงู) - ุฅุฌุจุงุฑู
  โ ููุน ุงููุงุฏุฉ - ุฅุฌุจุงุฑู
  โ ูููุน ุงูุชุฎุฒูู - ุฅุฌุจุงุฑู
  โญ ููุงุญุธุงุช - ุงุฎุชูุงุฑู
ุซู: ุงุถุบุท ุชุณุฌูู ุงูุขู
```

#### ุงูุฎุทูุฉ 3: ููู ุงูุจุถุงุนุฉ ููุฅูุชุงุฌ
```
ุจุนุฏ ุงูุชุณุฌูู:
  1. ุงุถุบุท ุนูู ุงูุดุญูุฉ ุงููุณุฌูุฉ
  2. ุงุถุบุท ุนูู: ๐ญ ููู ููุฅูุชุงุฌ
ุงููุชูุฌุฉ: 
  - ุญุงูุฉ ุงูุชุณุฌูู: in_production
  - ุงูุจุถุงุนุฉ ุฌุงูุฒุฉ ููุฅูุชุงุฌ
```

---

### ๐ ุงููุญุงุณุจ (Accountant)

#### ุงูุฎุทูุฉ 1: ุนุฑุถ ููุญุฉ ุงูุชุณููุฉ
```
ุงุฐูุจ ุฅูู: ๐ ุชุณููุฉ ุงูุจุถุงุนุฉ
ุณุชุฌุฏ:
  - ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ
  - ูุงุฆูุฉ ุงูุชุณููุงุช ุงููุนููุฉ
  - ููุงุชุฑ ุงูุจุญุซ
```

#### ุงูุฎุทูุฉ 2: ุฑุจุท ูุงุชูุฑุฉ
```
1. ุงูุณุฎ ุจูุงูุงุช ุงููุงุชูุฑุฉ ูู ุงูููุฑุฏ
2. ูู ููุญุฉ ุงูุชุณููุฉุ ุงุถุบุท ุนูู ุงูุดุญูุฉ
3. ุฃุฏุฎู:
   - ุฑูู ุงููุงุชูุฑุฉ
   - ุงููุฒู ูู ุงููุงุชูุฑุฉ
4. ุงุถุบุท: Link & Calculate
```

---

### ๐จโ๐ผ ูุฏูุฑ ุงูุฅูุชุงุฌ (Production Manager)

#### ุงูุฎุทูุฉ 1: ูุฑุงุฌุนุฉ ุงูุชุณููุงุช ุงููุนููุฉ
```
ุงุฐูุจ ุฅูู: ๐ ุชุณููุฉ ุงูุจุถุงุนุฉ
ุงุฎุชุฑ ุงูุชุณููุงุช ุจุญุงูุฉ "discrepancy" โ๏ธ
```

#### ุงูุฎุทูุฉ 2: ุงุชุฎุงุฐ ูุฑุงุฑ
```
ุณุชุฌุฏ ูู ุฌุฏูู ุงูููุงุฑูุฉ:

| ุงูุจูุงู | ุงููุนูู | ุงููุงุชูุฑุฉ | ุงููุฑู | ุงููุณุจุฉ |
|--------|--------|----------|--------|---------|
| ุงููุฒู | 1000 | 1050 | +50 | +5.0% |

ุงุฎุชุฑ ูู 3 ุฎูุงุฑุงุช:

1. โ ูุจูู ุงููุฑู
   โ reconciliation_status = "adjusted"
   โ ุฌุงูุฒ ููุฏูุน

2. โ ุฑูุถ ุงููุงุชูุฑุฉ
   โ reconciliation_status = "rejected"
   โ ุชุฑุฌุน ููููุฑุฏ

3. ๐ง ุชุนุฏูู ุงูุจูุงูุงุช
   โ ุนุฏููู ุงููุฒู ูุฏููุงู
   โ ูุถุญ ุงูุณุจุจ
```

---

## โจ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1๏ธโฃ ุชุณุฌูู ุขูู
```
- ูู ุดุญูุฉ ูุงุฒู ุชูุณุฌููู ูุจู ูุง ุชุทูุน ุงููุณุชูุฏุน
- ุชุณุฌูู ุชููุงุฆู ูููุฒู ูู ุงูููุฒุงู
- ุณุฌู audit trail ููู ุนูููุฉ ุชุณุฌูู
```

### 2๏ธโฃ ุญุณุงุจุงุช ุชููุงุฆูุฉ
```
- ุญุณุงุจ ุงููุฑู ุชููุงุฆูุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุญุณุงุจ ุงููุณุจุฉ ุงููุฆููุฉ
- ุญุณุงุจ ุงูุชุฃุซูุฑ ุงููุงูู
```

### 3๏ธโฃ ุชุตููู ุฐูู ูููุฑููุงุช
```
- < 1%   โ ุชูุจู ุชููุงุฆูุงู (matched)
- 1-5%   โ ุชุญุชุงุฌ ููุงููุฉ (discrepancy)
- > 5%   โ ุชุญุฐูุฑ (requires_review)
```

### 4๏ธโฃ ุชูุงุฑูุฑ ุดุงููุฉ
```
- ุฃุฏุงุก ุงูููุฑุฏูู
- ุงูุชุณููุงุช ุงูููุชููุฉ
- ุงููุฑููุงุช ุงููุจูุฑุฉ
- ุงูุฅุญุตุงุฆูุงุช ุงูููููุฉ
```

### 5๏ธโฃ Audit Trail ูุงูู
```
- ูู ุชุณุฌูู ูุณุฌูู
- ูู ูุฑุงุฑ ูุณุฌูู
- ูุนูููุงุช ุงููุณุชุฎุฏู ูุงูููุช
- IP Address ููุฃูุงู
```

---

## โ ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ

### ุณ: ูุงุฐุง ูุญุฏุซ ุฅุฐุง ูู ุชุณุฌูู ุงูุจุถุงุนุฉุ
**ุฌ:** ุงููุธุงู ูููุน ููููุง ููุฅูุชุงุฌ. ุชุธูุฑ ุฑุณุงูุฉ: "ุงูุจุถุงุนุฉ ูู ุชูุณุฌููู ูู ุงููุณุชูุฏุน ุจุนุฏ"

### ุณ: ุฅุฐุง ูุงู ุงููุฑู ูู ุงููุงุชูุฑุฉ ูุจูุฑุ
**ุฌ:** ูุชู ุนุฑุถ ุชุญุฐูุฑ ูููุฏูุฑ ููุฌุจ ุงูููุงููุฉ ุนููู ูุจู ุงูุฏูุน

### ุณ: ูู ูููู ุชุนุฏูู ุจูุงูุงุช ุจุนุฏ ุงูุชุณุฌููุ
**ุฌ:** ูุงุ ุฅุฐุง ููุช ุชุฑูุฏ ุชุนุฏูู ููููู ุชูููู ุงูุดุญูุฉ ุฃููุงู ุซู ูุชุญ ุงูููู

### ุณ: ูุงุฐุง ูู ุฑูุถูุง ุงููุงุชูุฑุฉุ
**ุฌ:** ูุชู ุชุญุฏูุซ ุญุงูุฉ ุงููุงุชูุฑุฉ ุฅูู "rejected" ูุชุฑุฌุน ููููุฑุฏ ููุชุตุญูุญ

### ุณ: ูู ููุงู ุณุฌู ูููุฑุงุฑุงุช ุงูุณุงุจูุฉุ
**ุฌ:** ูุนูุ ุฌุฏูู reconciliation_logs ูุณุฌู ูู ุงููุฑุงุฑุงุช ูุน ุงูุชูุงุตูู

### ุณ: ููู ุฃุดูู ุชูุฑูุฑ ุงูููุฑุฏููุ
**ุฌ:** ุงุฐูุจ ุฅูู ๐ ุชูุฑูุฑ ุงูููุฑุฏูู ูู ููุญุฉ ุงูุชุณููุฉ

---

## ๐ง Troubleshooting

### ุงููุดููุฉ: ุงูุฃูุฒุงู ูุง ุชุธูุฑ ูู ุงูุฌุฏูู

**ุงูุญู:**
```php
// ุชุฃูุฏ ูู ูุฌูุฏ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
php artisan tinker
DeliveryNote::where('actual_weight', '!=', null)->get();
```

### ุงููุดููุฉ: ุงูู Foreign Keys ูุง ุชุดุชุบู

**ุงูุญู:**
```php
// ุชุฃูุฏ ูู ุชูุนูู ุงูู foreign keys
php artisan migrate:refresh
```

### ุงููุดููุฉ: ุงูู Routes ูุง ุชุดุชุบู

**ุงูุญู:**
```php
// ุฅุนุงุฏุฉ ุชุญููู ุงูู routes
php artisan route:clear
php artisan route:cache
```

---

## ๐ ููุงุญุธุงุช ุชุทููุฑูุฉ

### ุฅุฐุง ุฃุฑุฏุช ุฅุถุงูุฉ ุญููู ุฌุฏูุฏุฉ:

1. ุฃูุดุฆ migration ุฌุฏูุฏุฉ:
```bash
php artisan make:migration add_new_field_to_delivery_notes --table=delivery_notes
```

2. ุฃุถู ุงูุญููู:
```php
Schema::table('delivery_notes', function (Blueprint $table) {
    $table->string('new_field')->nullable();
});
```

3. ุญุฏูุซ ุงูู Model
4. ุญุฏูุซ ุงูู Views ุฅุฐุง ูุฒู ุงูุฃูุฑ

### ุฅุฐุง ุฃุฑุฏุช ุชุบููุฑ ุงููุฆุงุช:

ุนุฏูู ูู `ReconciliationController.php`:

```php
// ูู method link():
if (abs($discrepancyPercentage) <= 1) {
    // ุบููุฑ ุงูุฑูู ุญุณุจ ุงุญุชูุงุฌู
    $deliveryNote->update(['reconciliation_status' => 'matched']);
}
```

---

## ๐ ุงูุฏุนู ุงูููู

ุฅุฐุง ูุงุฌูุช ูุดููุฉ:

1. ุชุญูู ูู ุงูู error logs:
```bash
tail -f storage/logs/laravel.log
```

2. ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```bash
php artisan tinker
DeliveryNote::latest()->first();
```

3. ุงุชุตู ุจูุฑูู ุงูุชุทููุฑ ูุน:
   - ุฑูู ุงูุฎุทุฃ
   - ุงูุฎุทูุงุช ููุชูุฑุงุฑ
   - ููุทุฉ ุดุงุดุฉ ููุฎุทุฃ

---

## โ Checklist ูุจู ุงูุงุณุชุฎุฏุงู

- [ ] ุชุดุบูู ุงูู migrations ุจูุฌุงุญ
- [ ] ุฅูุดุงุก ุฌููุน ุงูู Models
- [ ] ุฅูุดุงุก ุฌููุน ุงูู Controllers
- [ ] ุฅูุดุงุก ุฌููุน ุงูู Views
- [ ] ุฅุถุงูุฉ ุงูู Routes
- [ ] ุฅุถุงูุฉ ุงูู Navigation links
- [ ] ุงุฎุชุจุงุฑ ุงูุชุณุฌูู (happy path)
- [ ] ุงุฎุชุจุงุฑ ุงูุชุณููุฉ (happy path)
- [ ] ุงุฎุชุจุงุฑ ุงููุณุงุฑุงุช ุงูุฎุงุทุฆุฉ
- [ ] ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก ูุน ุจูุงูุงุช ูุจูุฑุฉ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 17 ููููุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 1.0  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ
