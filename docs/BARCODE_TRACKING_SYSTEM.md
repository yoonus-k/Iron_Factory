# ๐ ูุธุงู ุชุชุจุน ุงูุจุงุฑููุฏ - ุดุฑุญ ูุงูู

## ๐ฏ ุงููุฏู
ุชุชุจุน ุงูููุงุฏ ูู ุฏุฎูู ุงููุณุชูุฏุน ุฅูู ูุฑุงุญู ุงูุฅูุชุงุฌ ุงููุฎุชููุฉ ุจุงุณุชุฎุฏุงู ูุธุงู ุจุงุฑููุฏ ูุชูุงูู.

---

## ๐ฆ ูุฑุงุญู ุงูุชุชุจุน

### ุงููุฑุญูุฉ 1๏ธโฃ: ุฏุฎูู ุงููุณุชูุฏุน
**ุนูุฏ ุชุณุฌูู ุดุญูุฉ ุฌุฏูุฏุฉ ูู ุงููุณุชูุฏุน:**

```php
// ูุชู ุฅูุดุงุก:
MaterialBatch {
    batch_code: "RW-2025-001",  // โ ุจุงุฑููุฏ ุฏุฎูู ุงููุณุชูุฏุน
    initial_quantity: 1000,
    available_quantity: 1000,
    status: 'available'
}

DeliveryNote {
    batch_id: 1,
    quantity: 1000
}
```

**ูุง ููุญูุธ:**
- โ `material_batches.batch_code` = ุจุงุฑููุฏ ุงููุณุชูุฏุน
- โ `delivery_notes.batch_id` = ุฑุจุท ูุน ุงูุฏูุนุฉ

---

### ุงููุฑุญูุฉ 2๏ธโฃ: ุงูููู ููุฅูุชุงุฌ
**ุนูุฏ ููู ูููุฉ ููุฅูุชุงุฌ (ูุซูุงู 300 ูุฌู):**

```php
// ูุชู ุฅูุดุงุก ุจุงุฑููุฏ ุฌุฏูุฏ ููุฅูุชุงุฌ:
production_barcode = "PR-2025-001"

// ูุชู ุงูุชุญุฏูุซ:
MaterialBatch {
    batch_code: "RW-2025-001",           // ุงูุฃุตูู (ูุง ูุชุบูุฑ)
    latest_production_barcode: "PR-2025-001", // โ ุขุฎุฑ ุจุงุฑููุฏ ุฅูุชุงุฌ
    available_quantity: 700,              // 1000 - 300
    status: 'in_production'
}

DeliveryNote {
    production_barcode: "PR-2025-001",    // โ ุจุงุฑููุฏ ุงูุฅูุชุงุฌ
    quantity_used: 300,
    quantity_remaining: 700
}

ProductTracking {
    barcode: "PR-2025-001",               // โ ุงูุจุงุฑููุฏ ุงูุฑุฆูุณู
    input_barcode: "RW-2025-001",        // โ ูู ุฃูู ุฌุงุก (ุงููุณุชูุฏุน)
    output_barcode: "PR-2025-001",       // โ ุฅูู ุฃูู ุฐูุจ (ุงูุฅูุชุงุฌ)
    stage: 'warehouse',
    action: 'transferred_to_production',
    input_weight: 300,
    metadata: {
        original_barcode: "RW-2025-001",
        production_barcode: "PR-2025-001",
        batch_id: 1,
        delivery_note_id: 5
    }
}
```

---

### ุงููุฑุญูุฉ 3๏ธโฃ: ูุฑุงุญู ุงูุฅูุชุงุฌ ุงูุชุงููุฉ
**ุนูุฏ ูุนุงูุฌุฉ ุงููุงุฏุฉ ูู ุงูุฅูุชุงุฌ:**

```php
// ูุฑุญูุฉ 1: ุงููุทุน
ProductTracking {
    barcode: "PR-2025-002",              // ุจุงุฑููุฏ ุฌุฏูุฏ ูููุฑุญูุฉ
    input_barcode: "PR-2025-001",       // ูู ุงููุฑุญูุฉ ุงูุณุงุจูุฉ
    output_barcode: "PR-2025-002",      // ูููุฑุญูุฉ ุงูุชุงููุฉ
    stage: 'cutting',
    input_weight: 300,
    output_weight: 290,
    waste_amount: 10
}

// ูุฑุญูุฉ 2: ุงูุชุดููู
ProductTracking {
    barcode: "PR-2025-003",
    input_barcode: "PR-2025-002",
    output_barcode: "PR-2025-003",
    stage: 'forming',
    input_weight: 290,
    output_weight: 285,
    waste_amount: 5
}
```

---

## ๐ ููููุฉ ุงูุชุชุจุน

### 1. ุงูุชุชุจุน ูู ุงูููุชุฌ ุงูููุงุฆู ูููุงุฏุฉ ุงูุฎุงู

```php
// ุจุงุณุชุฎุฏุงู ุงูุฏุงูุฉ traceBack()
$chain = ProductTracking::traceBack('PR-2025-003');

// ุงููุชูุฌุฉ:
[
    { barcode: 'PR-2025-003', stage: 'forming', input: 'PR-2025-002' },
    { barcode: 'PR-2025-002', stage: 'cutting', input: 'PR-2025-001' },
    { barcode: 'PR-2025-001', stage: 'warehouse', input: 'RW-2025-001' }
]

// ุงูุขู ููููู ุงููุตูู ูููุตุฏุฑ ุงูุฃุตูู:
$originalBatch = MaterialBatch::where('batch_code', 'RW-2025-001')->first();
```

### 2. ุงูุชุชุจุน ูู ุงููุงุฏุฉ ุงูุฎุงู ููุฃูุงู

```php
// ุงูุจุญุซ ุนู ุฌููุน ูุฑุงุญู ููุชุฌ ูุนูู
$history = ProductTracking::where('input_barcode', 'RW-2025-001')
    ->orWhere('barcode', 'RW-2025-001')
    ->orderBy('created_at')
    ->get();

// ุฃู ุงุณุชุฎุฏุงู ุงูุฏุงูุฉ ุงููุฎุตุตุฉ:
$history = ProductTracking::getProductHistory('RW-2025-001');
```

### 3. ุงูุชุชุจุน ูู ุงูุฏูุนุฉ (Batch)

```php
// ุงูุญุตูู ุนูู ุฌููุน ุนูููุงุช ุงูููู ููุฅูุชุงุฌ ูู ุฏูุนุฉ ูุนููุฉ
$batch = MaterialBatch::find(1);

// ุงูุจุญุซ ูู product_tracking
$allProductionBarcodes = ProductTracking::whereJsonContains('metadata->batch_id', 1)->get();

// ุงูุญุตูู ุนูู ุขุฎุฑ ุจุงุฑููุฏ ุฅูุชุงุฌ
$latestProductionBarcode = $batch->latest_production_barcode;

// ุงูุญุตูู ุนูู ุฌููุน ุฃุฐููุงุช ุงูุชุณููู ุงููุฑุชุจุทุฉ
$deliveryNotes = DeliveryNote::where('batch_id', 1)->get();
```

---

## โ ูุฒุงูุง ูุฐู ุงูุทุฑููุฉ

### 1. **ุงูุชุชุจุน ุงููุงูู** ๐
- ููููู ุชุชุจุน ุงูููุชุฌ ูู ุงูููุงูุฉ ููุจุฏุงูุฉ
- ููููู ุชุชุจุน ุงููุงุฏุฉ ูู ุงูุจุฏุงูุฉ ููููุงูุฉ
- ุฌููุน ุงููุฑุงุญู ููุซูุฉ ูู `product_tracking`

### 2. **ุงูุฑุจุท ุงููุฒุฏูุฌ** ๐
- `material_batches` ูุญุชูุธ ุจุงูุจุงุฑููุฏ ุงูุฃุตูู + ุขุฎุฑ ุจุงุฑููุฏ ุฅูุชุงุฌ
- `delivery_notes` ูุญุชูุธ ุจุจุงุฑููุฏ ุงูุฅูุชุงุฌ ุงููุฑุชุจุท ุจูู ููู
- `product_tracking` ูุญุชูุธ ุจุณูุณูุฉ ูุงููุฉ ูู ุงูุจุงุฑููุฏุงุช

### 3. **ุงููุฑููุฉ** ๐ช
- ูููู ููู ูููุงุช ุฌุฒุฆูุฉ ูู ููุณ ุงูุฏูุนุฉ
- ูู ุนูููุฉ ููู ุชุญุตู ุนูู ุจุงุฑููุฏ ุฅูุชุงุฌ ูุฑูุฏ
- ุงูุชุงุฑูุฎ ุงููุงูู ูุญููุธ ูู metadata

### 4. **ุณูููุฉ ุงูุงุณุชุนูุงู** ๐
```php
// ุงูุญุตูู ุนูู ูู ุงูููุชุฌุงุช ูู ุฏูุนุฉ ูุนููุฉ
$batch = MaterialBatch::with(['deliveryNotes'])->find(1);
$productionBarcodes = $batch->deliveryNotes->pluck('production_barcode');

// ุงูุญุตูู ุนูู ุชุงุฑูุฎ ุจุงุฑููุฏ ูุนูู
$report = ProductTracking::fullReport('PR-2025-001');
```

---

## ๐ฏ ุณููุงุฑูู ุนููู ูุงูู

### ุงูุฎุทูุฉ 1: ูุตูู ุงูุดุญูุฉ
```
๐ฆ ูุตู 1000 ูุฌู ุญุฏูุฏ ูู ุงูููุฑุฏ
โโ ูููุดุฃ batch_code: "RW-2025-001"
```

### ุงูุฎุทูุฉ 2: ุงูููู ุงูุฃูู ููุฅูุชุงุฌ (300 ูุฌู)
```
๐ฆ RW-2025-001 (1000 ูุฌู)
โโ ๐ญ PR-2025-001 (300 ูุฌู) โ ูููู ููุฅูุชุงุฌ
โโ ๐ฆ 700 ูุฌู ูุชุจูู
```

### ุงูุฎุทูุฉ 3: ุงูููู ุงูุซุงูู ููุฅูุชุงุฌ (400 ูุฌู)
```
๐ฆ RW-2025-001 (700 ูุฌู)
โโ ๐ญ PR-2025-001 (300 ูุฌู) โ ุชู ุณุงุจูุงู
โโ ๐ญ PR-2025-005 (400 ูุฌู) โ ูููู ุงูููู
โโ ๐ฆ 300 ูุฌู ูุชุจูู
```

### ุงูุฎุทูุฉ 4: ูุฑุงุญู ุงูุฅูุชุงุฌ
```
๐ญ PR-2025-001 (300 ูุฌู)
โโ โ๏ธ PR-2025-002 (290 ูุฌู) โ ุจุนุฏ ุงููุทุน
โโ ๐จ PR-2025-003 (285 ูุฌู) โ ุจุนุฏ ุงูุชุดููู
โโ โ PR-2025-004 (280 ูุฌู) โ ููุชุฌ ููุงุฆู
```

---

## ๐ ุงูุฎูุงุตุฉ

### ุงูุทุฑููุฉ ุงูุญุงููุฉ ุตุญูุญุฉ โ ูุชููุฑ:

1. **ุซูุงุซ ูุณุชููุงุช ูู ุงูุญูุธ:**
   - `material_batches`: ุงูุจุงุฑููุฏ ุงูุฃุตูู + ุขุฎุฑ ุจุงุฑููุฏ ุฅูุชุงุฌ
   - `delivery_notes`: ุจุงุฑููุฏ ุงูุฅูุชุงุฌ ููู ุนูููุฉ ููู
   - `product_tracking`: ุงูุณูุณูุฉ ุงููุงููุฉ ูุน ุงูุชูุงุตูู

2. **ุชุชุจุน ูุงูู:**
   - ูู ุงูููุชุฌ ุงูููุงุฆู โ ุงููุงุฏุฉ ุงูุฎุงู โ
   - ูู ุงููุงุฏุฉ ุงูุฎุงู โ ุฌููุน ุงูููุชุฌุงุช โ
   - ุฌููุน ุงููุฑุงุญู ุงููุณูุทุฉ โ

3. **ูุฑููุฉ ุนุงููุฉ:**
   - ุฏุนู ุงูููู ุงูุฌุฒุฆู โ
   - ุฏุนู ุชุนุฏุฏ ูุฑุงุญู ุงูุฅูุชุงุฌ โ
   - ุญูุธ ุงูุชุงุฑูุฎ ุงููุงูู โ

**ูุนูุ ููููู ุงูุชุชุจุน ุจุดูู ูุงูู ูููุง ุจุนุฏ! ๐ฏ**
