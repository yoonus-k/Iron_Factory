# ูุธุงู ุงูููุชุฌุงุช ุงููุชุนุฏุฏุฉ ูู ููุงุชูุฑ ุงูุดุฑุงุก

## ๐ ูุธุฑุฉ ุนุงูุฉ
ุชู ุชุญุฏูุซ ูุธุงู ููุงุชูุฑ ุงูุดุฑุงุก ูุฏุนู ุฅุถุงูุฉ ุฃูุซุฑ ูู ููุชุฌ/ูุงุฏุฉ ูู ุงููุงุชูุฑุฉ ุงููุงุญุฏุฉุ ูุน ุฅููุงููุฉ ุญุณุงุจ ุงูุถุฑุงุฆุจ ูุงูุฎุตููุงุช ููู ููุชุฌ ุนูู ุญุฏุฉ.

## ๐ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### 1. ุฅุถุงูุฉ ููุชุฌุงุช ูุชุนุฏุฏุฉ
- ูููู ุฅุถุงูุฉ ุนุฏุฏ ุบูุฑ ูุญุฏูุฏ ูู ุงูููุชุฌุงุช ูู ุงููุงุชูุฑุฉ ุงููุงุญุฏุฉ
- ูู ููุชุฌ ูุญุชูู ุนูู ูุนูููุงุช ููุตูุฉ:
  - ุงุณู ุงูููุชุฌ
  - ุงููุตู (ุงุฎุชูุงุฑู)
  - ุงููููุฉ
  - ุงููุญุฏุฉ (ุทูุ ููููุ ูุชุฑุ ุฅูุฎ)
  - ุณุนุฑ ุงููุญุฏุฉ
  - ูุณุจุฉ ุงูุถุฑูุจุฉ
  - ูุณุจุฉ ุงูุฎุตู
  - ููุงุญุธุงุช ุฎุงุตุฉ ุจุงูููุชุฌ

### 2. ุงูุฑุจุท ูุน ุงูููุงุฏ ุงูููุฌูุฏุฉ
- ูููู ุงุฎุชูุงุฑ ูุงุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุนูุฏ ุงุฎุชูุงุฑ ูุงุฏุฉุ ูุชู ููุก ุงุณู ุงูููุชุฌ ูุงููุญุฏุฉ ุชููุงุฆููุง
- ูููู ุฃูุถูุง ุฅุฏุฎุงู ููุชุฌ ูุฏูููุง ุจุฏูู ุฑุจุทู ุจูุงุฏุฉ ููุฌูุฏุฉ

### 3. ุงูุญุณุงุจุงุช ุงูุชููุงุฆูุฉ
- ุญุณุงุจ ุงููุฌููุน ุงููุฑุนู ููู ููุชุฌ (ุงููููุฉ ร ุงูุณุนุฑ)
- ุญุณุงุจ ูููุฉ ุงูุถุฑูุจุฉ ููู ููุชุฌ
- ุญุณุงุจ ูููุฉ ุงูุฎุตู ููู ููุชุฌ
- ุญุณุงุจ ุงูุฅุฌูุงูู ุงูููุงุฆู ููู ููุชุฌ
- ุญุณุงุจ ุงูุฅุฌูุงูู ุงูููู ูููุงุชูุฑุฉ ุชููุงุฆููุง

### 4. ุนุฑุถ ููุฎุต ุงููุงุชูุฑุฉ
ูุชู ุนุฑุถ ููุฎุต ูู ุงูููุช ุงููุนูู ูุญุชูู ุนูู:
- ุงูุฅุฌูุงูู ุงููุฑุนู ูุฌููุน ุงูููุชุฌุงุช
- ูุฌููุน ุงูุถุฑุงุฆุจ
- ูุฌููุน ุงูุฎุตููุงุช
- ุงูุฅุฌูุงูู ุงูููุงุฆู

## ๐ ุงููููุงุช ุงููุถุงูุฉ/ุงููุนุฏููุฉ

### 1. Database Migration
```
database/migrations/2025_11_18_000001_create_purchase_invoice_items_table.php
```
ุฌุฏูู ุฌุฏูุฏ ูุชุฎุฒูู ููุชุฌุงุช ุงููุงุชูุฑุฉ

### 2. Model
```
app/Models/PurchaseInvoiceItem.php
```
ููุฏูู ุฌุฏูุฏ ูุฅุฏุงุฑุฉ ููุชุฌุงุช ุงููุงุชูุฑุฉ ูุน ุงูุญุณุงุจุงุช ุงูุชููุงุฆูุฉ

### 3. Controller Updates
```
Modules/Manufacturing/Http/Controllers/PurchaseInvoiceController.php
```
ุชุญุฏูุซุงุช ุนูู:
- `create()` - ุฅุถุงูุฉ ุงูููุงุฏ ููุงุฎุชูุงุฑ
- `store()` - ุญูุธ ุงูููุชุฌุงุช ูุน ุงููุงุชูุฑุฉ
- `edit()` - ุชุญููู ุงูููุชุฌุงุช ุงูุญุงููุฉ
- `update()` - ุชุญุฏูุซ ุงูููุชุฌุงุช
- `show()` - ุนุฑุถ ุงูููุชุฌุงุช ูุน ุงููุงุชูุฑุฉ

### 4. View Updates
```
Modules/Manufacturing/resources/views/warehouses/purchase-invoices/create.blade.php
Modules/Manufacturing/resources/views/warehouses/purchase-invoices/edit.blade.php
```
ูุงุฌูุฉ ูุณุชุฎุฏู ุฏููุงููููุฉ ูุน JavaScript ูุฅุฏุงุฑุฉ ุงูููุชุฌุงุช

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ
1. ุงููุฑ ุนูู ุฒุฑ "ุฅุถุงูุฉ ููุชุฌ"
2. ุงุฎุชุฑ ูุงุฏุฉ ูู ุงููุงุฆูุฉ (ุงุฎุชูุงุฑู) ุฃู ุฃุฏุฎู ูุฏูููุง
3. ุงููุฃ ุชูุงุตูู ุงูููุชุฌ (ุงููููุฉุ ุงูุณุนุฑุ ุฅูุฎ)
4. ูุชู ุญุณุงุจ ุงูุฅุฌูุงูู ุชููุงุฆููุง

### ุญุฐู ููุชุฌ
- ุงููุฑ ุนูู ุฒุฑ "ุญุฐู" ุจุฌุงูุจ ุงูููุชุฌ
- ูุชู ุฅุนุงุฏุฉ ุชุฑููู ุงูููุชุฌุงุช ุชููุงุฆููุง

### ุงูุญุณุงุจุงุช ุงูุฏููุงููููุฉ
- ุฃู ุชุบููุฑ ูู ุงููููุฉ ุฃู ุงูุณุนุฑ ุฃู ุงูุถุฑูุจุฉ ุฃู ุงูุฎุตู
- ูุชู ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุฅุฌูุงูู ููุฑูุง

## ๐ง ุงุณุชุฎุฏุงู ุงูู API

### ุฅูุดุงุก ูุงุชูุฑุฉ ูุน ููุชุฌุงุช

```php
POST /manufacturing/purchase-invoices

{
    "invoice_number": "INV-2024-001",
    "supplier_id": 1,
    "invoice_date": "2024-11-18",
    "currency": "SAR",
    "items": [
        {
            "material_id": 5,
            "item_name": "ุญุฏูุฏ ุชุณููุญ 12 ููู",
            "quantity": 100,
            "unit": "ุทู",
            "unit_price": 2500,
            "tax_rate": 15,
            "discount_rate": 5,
            "notes": "ููุงุญุธุฉ ุฎุงุตุฉ"
        },
        {
            "item_name": "ุฅุณููุช ุจูุฑุชูุงูุฏ",
            "quantity": 50,
            "unit": "ุทู",
            "unit_price": 350,
            "tax_rate": 15,
            "discount_rate": 0
        }
    ]
}
```

### ุชุญุฏูุซ ูุงุชูุฑุฉ

```php
PUT /manufacturing/purchase-invoices/{id}

// ููุณ ุงูุจููุฉ ุงูุณุงุจูุฉ
// ูุชู ุญุฐู ุงูููุชุฌุงุช ุงููุฏููุฉ ูุฅุถุงูุฉ ุงูุฌุฏูุฏุฉ
```

## ๐ ุงูุนูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### PurchaseInvoice Model
```php
public function items(): HasMany
{
    return $this->hasMany(PurchaseInvoiceItem::class);
}

public function calculateTotalFromItems(): float
{
    return $this->items()->sum('total') ?? 0;
}
```

### PurchaseInvoiceItem Model
```php
public function purchaseInvoice(): BelongsTo
{
    return $this->belongsTo(PurchaseInvoice::class);
}

public function material(): BelongsTo
{
    return $this->belongsTo(Material::class);
}
```

## ๐ ุจููุฉ ุฌุฏูู purchase_invoice_items

| Column | Type | Description |
|--------|------|-------------|
| id | bigint | ุงููุนุฑู ุงูุฑุฆูุณู |
| purchase_invoice_id | bigint | ูุนุฑู ุงููุงุชูุฑุฉ |
| material_id | bigint (nullable) | ูุนุฑู ุงููุงุฏุฉ (ุงุฎุชูุงุฑู) |
| item_name | string | ุงุณู ุงูููุชุฌ |
| description | text (nullable) | ูุตู ุงูููุชุฌ |
| quantity | decimal(12,3) | ุงููููุฉ |
| unit | string | ุงููุญุฏุฉ |
| unit_price | decimal(12,2) | ุณุนุฑ ุงููุญุฏุฉ |
| subtotal | decimal(12,2) | ุงููุฌููุน ุงููุฑุนู |
| tax_rate | decimal(5,2) | ูุณุจุฉ ุงูุถุฑูุจุฉ |
| tax_amount | decimal(12,2) | ูุจูุบ ุงูุถุฑูุจุฉ |
| discount_rate | decimal(5,2) | ูุณุจุฉ ุงูุฎุตู |
| discount_amount | decimal(12,2) | ูุจูุบ ุงูุฎุตู |
| total | decimal(12,2) | ุงูุฅุฌูุงูู |
| notes | text (nullable) | ููุงุญุธุงุช |
| created_at | timestamp | ุชุงุฑูุฎ ุงูุฅูุดุงุก |
| updated_at | timestamp | ุชุงุฑูุฎ ุงูุชุญุฏูุซ |

## โ ูุนุงุฏูุงุช ุงูุญุณุงุจ

```
ุงููุฌููุน ุงููุฑุนู = ุงููููุฉ ร ุณุนุฑ ุงููุญุฏุฉ
ูุจูุบ ุงูุถุฑูุจุฉ = ุงููุฌููุน ุงููุฑุนู ร (ูุณุจุฉ ุงูุถุฑูุจุฉ รท 100)
ูุจูุบ ุงูุฎุตู = ุงููุฌููุน ุงููุฑุนู ร (ูุณุจุฉ ุงูุฎุตู รท 100)
ุงูุฅุฌูุงูู = ุงููุฌููุน ุงููุฑุนู + ูุจูุบ ุงูุถุฑูุจุฉ - ูุจูุบ ุงูุฎุตู

ุฅุฌูุงูู ุงููุงุชูุฑุฉ = ูุฌููุน ุฌููุน ุงูููุชุฌุงุช (total)
```

## ๐ฏ ูุซุงู ุชุทุจููู

### ุณููุงุฑูู: ูุงุชูุฑุฉ ุดุฑุงุก ุญุฏูุฏ ูุฅุณููุช

**ุงูููุชุฌ 1: ุญุฏูุฏ ุชุณููุญ**
- ุงููููุฉ: 100 ุทู
- ุณุนุฑ ุงููุญุฏุฉ: 2,500 ุฑูุงู
- ุงููุฌููุน ุงููุฑุนู: 250,000 ุฑูุงู
- ุงูุถุฑูุจุฉ (15%): 37,500 ุฑูุงู
- ุงูุฎุตู (5%): 12,500 ุฑูุงู
- ุงูุฅุฌูุงูู: 275,000 ุฑูุงู

**ุงูููุชุฌ 2: ุฅุณููุช**
- ุงููููุฉ: 50 ุทู
- ุณุนุฑ ุงููุญุฏุฉ: 350 ุฑูุงู
- ุงููุฌููุน ุงููุฑุนู: 17,500 ุฑูุงู
- ุงูุถุฑูุจุฉ (15%): 2,625 ุฑูุงู
- ุงูุฎุตู (0%): 0 ุฑูุงู
- ุงูุฅุฌูุงูู: 20,125 ุฑูุงู

**ุฅุฌูุงูู ุงููุงุชูุฑุฉ: 295,125 ุฑูุงู**

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

1. **ุฅุถุงูุฉ ุชุตุฏูุฑ PDF**
   - ุทุจุงุนุฉ ุงููุงุชูุฑุฉ ูุน ูู ุงูููุชุฌุงุช

2. **ุชูุงุฑูุฑ ุชูุตูููุฉ**
   - ุชูุฑูุฑ ุจุงูููุชุฌุงุช ุงูุฃูุซุฑ ุดุฑุงุกู
   - ุชูุฑูุฑ ุจุงูููุฑุฏูู ุญุณุจ ููุน ุงููุงุฏุฉ

3. **ุฑุจุท ูุน ุงููุฎุฒูู**
   - ุชุญุฏูุซ ุงููุฎุฒูู ุชููุงุฆููุง ุนูุฏ ุงูููุงููุฉ ุนูู ุงููุงุชูุฑุฉ

4. **ุงููุณุฎ ูุงูุชูุฑุงุฑ**
   - ูุณุฎ ููุชุฌุงุช ูู ูุงุชูุฑุฉ ุณุงุจูุฉ

## ๐ ููุงุญุธุงุช ูุงูุฉ

1. **ุงูุญุณุงุจุงุช ุงูุชููุงุฆูุฉ**: ุฌููุน ุงูุญุณุงุจุงุช ุชุชู ุชููุงุฆููุง ุนูุฏ ุงูุญูุธ
2. **ุงูุญุฏ ุงูุฃุฏูู**: ูุฌุจ ุฅุถุงูุฉ ููุชุฌ ูุงุญุฏ ุนูู ุงูุฃูู
3. **ุงูุญุฐู ุงููุชุณูุณู**: ุญุฐู ุงููุงุชูุฑุฉ ูุญุฐู ุฌููุน ุงูููุชุฌุงุช ุชููุงุฆููุง
4. **ุงูู Validation**: ุฌููุน ุงูุญููู ุงููุทููุจุฉ ูุญููุฉ ูู ุงูู backend

## ๐ ุงูุฎูุงุตุฉ

ุชู ุชุทููุฑ ูุธุงู ูุชูุงูู ูุฅุฏุงุฑุฉ ููุชุฌุงุช ููุงุชูุฑ ุงูุดุฑุงุก ูุน:
- โ ูุงุฌูุฉ ูุณุชุฎุฏู ุณููุฉ ูุฏููุงููููุฉ
- โ ุญุณุงุจุงุช ุชููุงุฆูุฉ ุฏูููุฉ
- โ ุฑุจุท ูุน ูุธุงู ุงูููุงุฏ
- โ ุฏุนู ุงูุถุฑุงุฆุจ ูุงูุฎุตููุงุช
- โ ุชุญุฏูุซุงุช ุณูุณุฉ ูู ุงูููุช ุงููุนูู

---
**ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 18 ููููุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ**: 1.0
