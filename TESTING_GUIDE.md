# ุฏููู ุงูุงุฎุชุจุงุฑ ุงูุณุฑูุน - ูุธุงู ูุฑุงูุจุฉ ุงููุฏุฑ ุงููุฑุญูุฉ ุงูุฃููู

## โ ูุง ุชู ุชูููุฐู

### 1. **ุงูุฅุนุฏุงุฏุงุช**
- โ ุฅุนุฏุงุฏ ูุงุญุฏ ููุณุจุฉ ุงููุฏุฑ: `production_waste_percentage = 3%`
- โ ุชูุนูู ุงูุชูุจููุงุช: `enable_waste_alerts = 1`
- โ ุงูุฅููุงู ุงูุชููุงุฆู: `auto_suspend_on_waste_exceed = 1`

### 2. **ุงูุฌุฏุงูู**
- โ `stage_suspensions` - ุฌุงูุฒ
- โ `system_settings` - ุฌุงูุฒ
- โ `notifications` - ููุฌูุฏ

### 3. **ุงูุตูุงุญูุงุช**
```
STAGE_SUSPENSION_VIEW     โ
STAGE_SUSPENSION_APPROVE  โ
STAGE_SUSPENSION_REJECT   โ
```

### 4. **ุงูููุฏ**
- โ `Stage1Controller` - ุชู ุฅุถุงูุฉ ูุญุต ุงููุฏุฑ
- โ `WasteCheckService` - ุฌุงูุฒ
- โ `SystemSettingsHelper` - ุฌุงูุฒ
- โ `StageSuspensionController` - ุฌุงูุฒ
- โ View ุงููุฑุญูุฉ ุงูุฃููู - ุชู ุฅุถุงูุฉ ุฑุณุงูุฉ ุงูุฅููุงู

### 5. **ุงููุงุฌูุฉ**
- โ ุงูุณุงูุฏ ุจุงุฑ - ุฑุงุจุท "ุงููุฑุงุญู ุงููููููุฉ" ูุน badge
- โ ุตูุญุฉ ุนุฑุถ ุงููุฑุงุญู ุงููููููุฉ
- โ ุฑุณุงูุฉ ุชูุจูู ูู ุงููุฑุญูุฉ ุงูุฃููู ุนูุฏ ุงูุชุฌุงูุฒ

---

## ๐งช ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

### 1. **ุฅุนุทุงุก ุงูุตูุงุญูุงุช ูููุณุชุฎุฏู**

ุฃููุงูุ ุฃุนุท ุตูุงุญูุงุช ุงููุดุงูุฏุฉ ูุงูููุงููุฉ ููุณุชุฎุฏู Admin:

```sql
-- ูููุณุชุฎุฏู ุงูุญุงูู (user_id = 1 ูุซูุงู)
INSERT INTO role_permissions (role_id, permission_id)
SELECT 
    1, -- role_id (ADMIN)
    p.id
FROM permissions p
WHERE p.name IN ('STAGE_SUSPENSION_VIEW', 'STAGE_SUSPENSION_APPROVE', 'STAGE_SUSPENSION_REJECT');
```

ุฃู ูู Dashboard:
```
Dashboard โ ุงูุฅุฏุงุฑุฉ โ ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ โ ุงุฎุชุฑ ุฏูุฑ โ ุฃุถู ุงูุตูุงุญูุงุช ุงูุซูุงุซุฉ
```

### 2. **ุชุบููุฑ ูุณุจุฉ ุงููุฏุฑ ููุงุฎุชุจุงุฑ (ุงุฎุชูุงุฑู)**

ูุชุณููู ุงูุงุฎุชุจุงุฑุ ููู ูุณุจุฉ ุงููุฏุฑ ุงููุณููุญ ุจูุง:

```
Dashboard โ ุงูุฅุนุฏุงุฏุงุช โ ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ โ waste_limits
ุบูุฑ production_waste_percentage ูู 3 ุฅูู 1
```

### 3. **ุงุฎุชุจุงุฑ ุงููุฑุญูุฉ ุงูุฃููู**

1. ุงุฐูุจ ุฅูู: `Dashboard โ ุงููุฑุงุญู ุงูุฅูุชุงุฌูุฉ โ ุงููุฑุญูุฉ ุงูุฃููู`

2. ุฃุฏุฎู ุจุงุฑููุฏ ูุงุฏุฉ ุฎุงู

3. ุงุฎุชุฑ ุงุณุชุงูุฏ ูุฃุฏุฎู ุงูุฃูุฒุงู:
   - **ุงููุฒู ุงูููู**: 1000 ูุฌู
   - **ุงููุฒู ุงูุตุงูู**: 950 ูุฌู (ูุฏุฑ 5%)
   - **ูุฒู ุงููุฏุฑ**: 50 ูุฌู

4. ุงุถุบุท "ุญูุธ"

### 4. **ุงููุชูุฌุฉ ุงููุชููุนุฉ**

ุณูุธูุฑ **ูุงูุฐุฉ ุชูุจูู ูุจูุฑุฉ** ุชุญุชูู ุนูู:

```
โ๏ธ ุชุฌุงูุฒ ูุณุจุฉ ุงููุฏุฑ ุงููุณููุญ ุจูุง

ูุณุจุฉ ุงููุฏุฑ: 5% (ุงููุณููุญ ุจู: 3%)
ุณูุชู ุงููุฑุงุฌุนุฉ ูุจู ุงูุงุณุชูุฑุงุฑ.

ุชูุงุตูู ุงููุฏุฑ:
โโ ุงููุฒู ุงููุฏุฎู: 1000 ูุฌู
โโ ุงููุฒู ุงููุงุชุฌ: 950 ูุฌู  
โโ ูุฒู ุงููุฏุฑ: 50 ูุฌู
โโ ูุณุจุฉ ุงููุฏุฑ: 5%
โโ ุงููุณุจุฉ ุงููุณููุญ ุจูุง: 3%

โ๏ธ ุชู ุฅุฑุณุงู ุชูุจูู ููุฅุฏุงุฑุฉ ูููุฑุงุฌุนุฉ ูุงูููุงููุฉ.
ูู ุชุชููู ูู ุงูุงุณุชูุฑุงุฑ ูู ูุฐู ุงููุฑุญูุฉ ุญุชู ุชุชู ุงูููุงููุฉ.
```

### 5. **ุนุฑุถ ุงููุฑุงุญู ุงููููููุฉ**

1. ุงุฐูุจ ุฅูู: `Dashboard โ ุงููุฑุงุญู ุงููููููุฉ`

2. ุณุชุฌุฏ ูุงุฆูุฉ ุจุงููุฑุงุญู ุงููููููุฉ ูุน:
   - ุฑูู ุงููุฑุญูุฉ
   - ุงูุจุงุฑููุฏ
   - ุงูุฃูุฒุงู
   - ูุณุจุฉ ุงููุฏุฑ
   - ุชุงุฑูุฎ ุงูุฅููุงู

### 6. **ุงูููุงููุฉ ุนูู ุงูุงุณุชุฆูุงู**

1. ูู ุตูุญุฉ ุงููุฑุงุญู ุงููููููุฉ
2. ุงุถุบุท ุฒุฑ "ุงูููุงููุฉ ุนูู ุงูุงุณุชุฆูุงู"
3. ุฃุถู ููุงุญุธุงุช (ุงุฎุชูุงุฑู)
4. ุฃูุฏ ุงูููุงููุฉ

**ุงููุชูุฌุฉ**: ุชุชู ุฅุนุงุฏุฉ ุชูุนูู ุงููุฑุญูุฉ ููููู ุงูุงุณุชูุฑุงุฑ ูู ุงูุฅูุชุงุฌ

---

## ๐ ูุญุต ุงูุจูุงูุงุช

### 1. **ุนุฑุถ ุงูุฅุนุฏุงุฏุงุช**
```sql
SELECT setting_key, setting_value, description 
FROM system_settings 
WHERE category = 'waste_limits';
```

### 2. **ุนุฑุถ ุงููุฑุงุญู ุงููููููุฉ**
```sql
SELECT id, stage_number, batch_barcode, 
       waste_percentage, allowed_percentage, 
       status, suspended_at
FROM stage_suspensions
ORDER BY suspended_at DESC;
```

### 3. **ุนุฑุถ ุงูุชูุจููุงุช ุงููุฑุณูุฉ**
```sql
SELECT user_id, title, message, created_at
FROM notifications
WHERE type = 'stage_waste_exceeded'
ORDER BY created_at DESC
LIMIT 10;
```

---

## ๐ฏ ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### ุณููุงุฑูู 1: ูุฏุฑ ุถูู ุงูุญุฏ ุงููุณููุญ
```
ุงููุฒู ุงููุฏุฎู: 1000 ูุฌู
ุงููุฒู ุงููุงุชุฌ: 975 ูุฌู
ูุณุจุฉ ุงููุฏุฑ: 2.5%
ุงููุชูุฌุฉ: โ ูุชู ุงูุญูุธ ุจูุฌุงุญ
```

### ุณููุงุฑูู 2: ูุฏุฑ ูุชุฌุงูุฒ ุงูุญุฏ
```
ุงููุฒู ุงููุฏุฎู: 1000 ูุฌู
ุงููุฒู ุงููุงุชุฌ: 950 ูุฌู
ูุณุจุฉ ุงููุฏุฑ: 5%
ุงููุชูุฌุฉ: โ๏ธ ุฅููุงู ุงููุฑุญูุฉ + ุชูุจูู
```

### ุณููุงุฑูู 3: ูุฏุฑ ุจุงูุถุจุท ุนูุฏ ุงูุญุฏ
```
ุงููุฒู ุงููุฏุฎู: 1000 ูุฌู
ุงููุฒู ุงููุงุชุฌ: 970 ูุฌู
ูุณุจุฉ ุงููุฏุฑ: 3%
ุงููุชูุฌุฉ: โ ูุชู ุงูุญูุธ ุจูุฌุงุญ
```

---

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ุชุธูุฑ ุฑุณุงูุฉ ุงูุฅููุงู
**ุงูุญู**:
1. ุชุฃูุฏ ูู ุฃู `auto_suspend_on_waste_exceed = 1` ูู ุงูุฅุนุฏุงุฏุงุช
2. ุชุญูู ูู ูุฌูุฏ SweetAlert ูู ุงูุตูุญุฉ
3. ุงูุชุญ Console ูู ุงููุชุตูุญ ูุงุจุญุซ ุนู ุฃุฎุทุงุก JavaScript

### ุงููุดููุฉ: ูุง ูุชู ุฅุฑุณุงู ุชูุจููุงุช
**ุงูุญู**:
1. ุชุฃูุฏ ูู ุฃู `enable_waste_alerts = 1`
2. ุชุญูู ูู ุฌุฏูู `notifications`
3. ุชุฃูุฏ ูู ูุฌูุฏ ูุณุชุฎุฏููู ูุฏููู ุตูุงุญูุฉ `STAGE_SUSPENSION_APPROVE`

### ุงููุดููุฉ: ูุง ุชุธูุฑ ูุงุฆูุฉ ุงููุฑุงุญู ุงููููููุฉ ูู ุงูุณุงูุฏ ุจุงุฑ
**ุงูุญู**:
1. ุฃุนุท ุงููุณุชุฎุฏู ุตูุงุญูุฉ `STAGE_SUSPENSION_VIEW`
2. ุงูุณุญ cache ุงููุชุตูุญ

---

## ๐ ููุงุญุธุงุช ูููุฉ

โ๏ธ **ุงููุฑุญูุฉ ุชูููู ููุฑุงู** - ูุง ูุชู ุญูุธ ุงูุจูุงูุงุช ุญุชู ุงูููุงููุฉ
โ๏ธ **ุงูุชูุจููุงุช ููุฑูุฉ** - ูุชู ุฅุฑุณุงููุง ูู ููุณ ูุญุธุฉ ุงูุฅููุงู
โ๏ธ **ุงููุณุจุฉ ูุงุจูุฉ ููุชุนุฏูู** - ูู ุตูุญุฉ ุงูุฅุนุฏุงุฏุงุช
โ๏ธ **ุงูุชุทุจูู ุญุงููุงู ุนูู ุงููุฑุญูุฉ ุงูุฃููู ููุท** - ูููู ุชุทุจููู ุนูู ุงููุฑุญูุฉ ุงูุซุงููุฉ ุจููุณ ุงูุทุฑููุฉ

---

## โจ ุงูุฎุทูุฉ ุงูุชุงููุฉ

ูุชุทุจูู ููุณ ุงููุธุงู ุนูู **ุงููุฑุญูุฉ ุงูุซุงููุฉ**:

1. ุงูุชุญ `Stage2Controller.php`
2. ุฃุถู ููุณ ุงูููุฏ ูู method `store`
3. ุบูุฑ `stageNumber: 1` ุฅูู `stageNumber: 2`

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉุ ุชุญูู ูู:
- ููู ุงูู logs: `storage/logs/laravel.log`
- ุฌุฏูู `stage_suspensions` ููุชุฃูุฏ ูู ุงูุชุณุฌูู
- Console ุงููุชุตูุญ ููุฃุฎุทุงุก ูู JavaScript
