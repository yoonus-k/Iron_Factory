# ุดุฑุญ ุดุงูู: ููู ุงููุฑุงุญู ูุงูุนูุงู ุจูู ุงููุฑุฏูุงุช

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุฅุถุงูุฉ ูุธุงู ูุชูุฏู ูููู ุงููุฑุงุญู (ุงูุณุชุงูุฏุงุช) ูุงูุนูุงู ูู ูุฑุฏูุฉ ุฅูู ุฃุฎุฑู ูุน ุงูุญูุงุธ ุนูู ุณุฌู ุงูุนูููุงุช ูุงูุชุชุจุน ุงููุงูู.

---

## ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1๏ธโฃ ููู ุงููุฑุญูุฉ (ุงูุณุชุงูุฏ) ุจูู ุงููุฑุฏูุงุช

#### ูุง ูู ุงููุฑุญูุฉุ
- ุงูุณุชุงูุฏ (Stand) ุงูุฐู ูุชู ุงูุนูู ุนููู ูู ูุฑุญูุฉ ูุนููุฉ
- ูุฑุชุจุท ุจูุฑุฏูุฉ ูุญุฏุฏุฉ ูุนุงูู ูุนูู

#### ุงููุงุฆุฏุฉ:
- ููู ุงูุณุชุงูุฏ ูู ุนุงูู ูุขุฎุฑ
- ููู ุงูุณุชุงูุฏ ูู ูุฑุฏูุฉ ูุฃุฎุฑู
- ุชุชุจุน ูุงูู ููููู ูุชุงุฑูุฎ ุงูุนูููุงุช

#### ุฎุทูุงุช ุงูุงุณุชุฎุฏุงู:

**ุงูุทุฑููุฉ 1: ูู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ**
```
ููู ุงููุฑุฏูุงุช โ ููู ุงููุฑุญูุฉ
```

**ุงูุทุฑููุฉ 2: ูู ุงูู URL**
```
/shift-handovers/transfer-stage?stage_number=1&stage_record_id=123
```

#### ุงูุฎุทูุงุช:
1. โ ุชุญุฏูุฏ ุงููุฑุฏูุฉ ุงูุญุงููุฉ (ุชููุฃ ุชููุงุฆูุงู)
2. โ ุงุฎุชูุงุฑ ุงููุฑุฏูุฉ ุงููุณุชูุฏูุฉ
3. โ ุฅุถุงูุฉ ููุงุญุธุงุช (ุงุฎุชูุงุฑู)
4. โ ุชุฃููุฏ ุงูููู

#### ูุง ูุญุฏุซ ุนูุฏ ุงูููู:
- **ุชุญุฏูุซ ุงููุฑุฏูุฉ ุงูุฌุฏูุฏุฉ**: ุฅุถุงูุฉ ูุนุฑู ุงููุฑุญูุฉ ูุจุงุฑููุฏูุง
- **ุชุญุฑูุฑ ุงููุฑุฏูุฉ ุงููุฏููุฉ**: ุฅุฒุงูุฉ ูุนุฑู ุงููุฑุญูุฉ ูููุง
- **ุชุณุฌูู ุงูุนูููุฉ**: ุฅูุดุงุก ุณุฌู ูู `shift_handovers`
- **ุชุชุจุน ุงูุนูุงู**: ุฅููุงุก ุณุฌู ุงูุนูุงู ุงููุดุทูู ูุชุณุฌูู ุงูููู

---

### 2๏ธโฃ ููู ุงูุนูุงู ุจูู ุงููุฑุฏูุงุช

#### ูุง ูู ููู ุงูุนูุงูุ
- ููู ุนุงูู ุฃู ูุฌููุนุฉ ูู ุงูุนูุงู ูู ูุฑุฏูุฉ ุฅูู ุฃุฎุฑู
- ูุณุชูุฑ ุงูุนูู ุนูู ููุณ ุงููุฑุญูุฉ ููู ูุน ูุฑูู ุนูู ุฌุฏูุฏ

#### ุงููุงุฆุฏุฉ:
- ุฅุนุงุฏุฉ ุชูุฒูุน ุงูุนูู
- ูุนุงูุฌุฉ ูุดุงูู ุงูุชูุฒูุน
- ุชุญุณูู ุงูุฅูุชุงุฌูุฉ

#### ุฎุทูุงุช ุงูุงุณุชุฎุฏุงู:

**ุงูุทุฑููุฉ 1: ูู ุงููุงุฆูุฉ**
```
ููู ุงููุฑุฏูุงุช โ ููู ุงูุนูุงู
```

**ุงูุทุฑููุฉ 2: ูู ุงูู URL**
```
/shift-handovers/transfer-workers?from_shift_id=1&to_shift_id=2
```

#### ุงูุฎุทูุงุช:
1. โ ุงุฎุชูุงุฑ ุงููุฑุฏูุฉ ุงููุตุฏุฑ (ุงููุฑุฏูุฉ ุงูุชู ูุนูู ูููุง ุงูุนุงูู ุญุงููุงู)
2. โ ุชุญุฏูุฏ ุงูุนูุงู ุงูุฐูู ุชุฑูุฏ ููููู (ูููู ุชุญุฏูุฏ ุนุฏุฉ ุนูุงู)
3. โ ุงุฎุชูุงุฑ ุงููุฑุฏูุฉ ุงููุณุชูุฏูุฉ
4. โ ุฅุถุงูุฉ ููุงุญุธุงุช (ุงุฎุชูุงุฑู)
5. โ ุชุฃููุฏ ุงูููู

#### ูุง ูุญุฏุซ ุนูุฏ ุงูููู:
- **ุฅููุงุก ุงูุณุฌู ุงููุฏูู**: ุชุณุฌูู ููุงูุฉ ุงูุนูู ูู ุงููุฑุฏูุฉ ุงูุฃููู
- **ุฅูุดุงุก ุณุฌู ุฌุฏูุฏ**: ุชุณุฌูู ุจุฏุก ุงูุนูู ูู ุงููุฑุฏูุฉ ุงูุซุงููุฉ
- **ุชุญุฏูุซ ุงูุณุฌูุงุช**: ุฑุจุท ุงูุนูุงู ุจุงููุฑุฏูุฉ ุงูุฌุฏูุฏุฉ
- **ุชูุซูู ุงูุนูููุฉ**: ุญูุธ ุงูููู ูู `shift_handovers`

---

## ุงูุจูุงูุงุช ูุงูุฌุฏุงูู ุงููุชุฃุซุฑุฉ

### 1. ุฌุฏูู `shift_handovers`
ูุชู ุฅุถุงูุฉ ุณุฌู ุฌุฏูุฏ ูุญุชูู ุนูู:

```json
{
  "from_user_id": 1,           // ุงูุนุงูู/ุงููุณุคูู ุงูุฃูู
  "to_user_id": 2,             // ุงูุนุงูู/ุงููุณุคูู ุงูุซุงูู
  "from_shift_id": 10,         // ุงููุฑุฏูุฉ ุงูุฃููู (ุงุฎุชูุงุฑู)
  "to_shift_id": 11,           // ุงููุฑุฏูุฉ ุงูุซุงููุฉ (ุงุฎุชูุงุฑู)
  "stage_number": 1,           // ุงููุฑุญูุฉ
  "handover_items": {
    "stage_record_id": 123,
    "stage_record_barcode": "STG-001-123",
    "transfer_type": "stage_transfer",  // ุฃู "workers_transfer"
    "transferred_workers_count": 3      // ููุท ุนูุฏ ููู ุนูุงู
  },
  "notes": "ููู ุงููุฑุญูุฉ ูู ุงูุณุชุงูุฏ ุฑูู: 123",
  "handover_time": "2025-01-15 10:30:00",
  "supervisor_approved": false
}
```

### 2. ุฌุฏูู `worker_stage_history`
- **ุฅููุงุก ุงูุณุฌูุงุช ุงููุฏููุฉ**: ูุถุน `is_active = false` ู `ended_at = now()`
- **ุฅูุดุงุก ุณุฌูุงุช ุฌุฏูุฏุฉ**: ูุถุน `is_active = true` ู `started_at = now()` ูุน ุงููุฑุฏูุฉ ุงูุฌุฏูุฏุฉ

### 3. ุฌุฏูู `shift_assignments`
ุชุญุฏูุซ ุงูุญููู:
- `stage_record_id`: ูุนุฑู ุงููุฑุญูุฉ ุงูุญุงููุฉ
- `stage_record_barcode`: ุจุงุฑููุฏ ุงููุฑุญูุฉ
- `stage_number`: ุฑูู ุงููุฑุญูุฉ

---

## ุงูุฃุฐููุงุช ุงููุทููุจุฉ

```php
'SHIFT_HANDOVERS_CREATE'  // ุฅูุดุงุก/ุชูููุฐ ุงูููู
'SHIFT_HANDOVERS_READ'    // ุนุฑุถ ุณุฌูุงุช ุงูููู
'SHIFT_HANDOVERS_APPROVE' // ุงูููุงููุฉ ุนูู ุงูููู
```

---

## ุงูู Routes ุงููุชุงุญุฉ

### ููู ุงููุฑุญูุฉ:
```php
// ุนุฑุถ ุตูุญุฉ ุงูููู
GET  /shift-handovers/transfer-stage
     ?stage_number=1&stage_record_id=123

// ุชูููุฐ ุงูููู
POST /shift-handovers/transfer-stage/store

// ุงูุญุตูู ุนูู ุงููุฑุฏูุงุช ุงููุชุงุญุฉ (API)
GET  /shift-handovers/api/available-shifts
     ?stage_number=1&exclude_shift_id=10
```

### ููู ุงูุนูุงู:
```php
// ุนุฑุถ ุตูุญุฉ ุงูููู
GET  /shift-handovers/transfer-workers
     ?from_shift_id=1&to_shift_id=2

// ุชูููุฐ ุงูููู
POST /shift-handovers/transfer-workers/store

// ุงูุญุตูู ุนูู ุงูุนูุงู ุงููุดุทูู (API)
GET  /shift-handovers/api/active-workers
     ?shift_id=1
```

---

## ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ููู ุณุชุงูุฏ ูู ุนุงูู ูุขุฎุฑ

**ุงูุณููุงุฑูู:**
- ุงูุนุงูู ุฃุญูุฏ ูุนูู ุนูู ุงูุณุชุงูุฏ ุฑูู 100 ูู ุงููุฑุญูุฉ ุงูุฃููู
- ูุฑูุฏ ููู ููุณ ุงูุณุชุงูุฏ ููุนุงูู ุณุงูู

**ุงูุฎุทูุงุช:**
1. ุงูุฐูุงุจ ุฅูู: `/shift-handovers/transfer-stage?stage_number=1&stage_record_id=100`
2. ุชุญุฏูุฏ ุงููุฑุฏูุฉ ุงูุญุงููุฉ (ุชููุฃ ุชููุงุฆูุงู)
3. ุงุฎุชูุงุฑ ุงููุฑุฏูุฉ ุงูุฎุงุตุฉ ุจุณุงูู
4. ุฅุถุงูุฉ ููุงุญุธุฉ: "ููู ุงูุณุชุงูุฏ ูุนุฏู ุชููุฑ ุฃุญูุฏ"
5. ุชุฃููุฏ ุงูููู

**ุงููุชูุฌุฉ:**
- โ ุงูุณุชุงูุฏ ุงูุขู ูุฑุชุจุท ุจูุฑุฏูุฉ ุณุงูู
- โ ุฌููุน ุงูุนูุงู ุงูุฐูู ูุงููุง ูุนูููู ุนูู ูุฐุง ุงูุณุชุงูุฏ ูุน ุฃุญูุฏ ูุชู ุชุณุฌูู ููููู
- โ ุณุฌู ุงูุนูููุฉ ูุธูุฑ ูู `shift_handovers`

---

### ูุซุงู 2: ููู ุนุงูู ูู ูุฑูู ูุขุฎุฑ

**ุงูุณููุงุฑูู:**
- ุนุงูู ูุญูุฏ ูุนูู ูู ูุฑูู ุงููุฑุฏูุฉ ุงูุตุจุงุญูุฉ
- ูุฑูุฏ ูููู ูููุฑุฏูุฉ ุงููุณุงุฆูุฉ

**ุงูุฎุทูุงุช:**
1. ุงูุฐูุงุจ ุฅูู: `/shift-handovers/transfer-workers`
2. ุชุญุฏูุฏ ุงููุฑุฏูุฉ ุงูุตุจุงุญูุฉ ููุตุฏุฑ
3. ุชุญุฏูุฏ ูุญูุฏ ูู ูุงุฆูุฉ ุงูุนูุงู
4. ุงุฎุชูุงุฑ ุงููุฑุฏูุฉ ุงููุณุงุฆูุฉ
5. ุฅุถุงูุฉ ููุงุญุธุฉ: "ููู ูุญูุฏ ูููุฑุฏูุฉ ุงููุณุงุฆูุฉ"
6. ุชุฃููุฏ ุงูููู

**ุงููุชูุฌุฉ:**
- โ ูุญูุฏ ุงูุขู ูู ุงููุฑุฏูุฉ ุงููุณุงุฆูุฉ
- โ ููุช ุนููู ูู ุงููุฑุฏูุฉ ุงูุฃููู ูุณุฌู
- โ ุจุฏุงูุฉ ุนููู ุงูุฌุฏูุฏุฉ ูุน ุงููุฑุฏูุฉ ุงูุซุงููุฉ ูุณุฌูุฉ

---

### ูุซุงู 3: ููู ูุฌููุนุฉ ุนูุงู

**ุงูุณููุงุฑูู:**
- ูุฑูู ูููู ูู 3 ุนูุงู (ุฃุญูุฏุ ุนููุ ูุญููุฏ) ูุนูููู ุนูู ููุณ ุงููุฑุญูุฉ
- ูุฑูุฏ ููู ุฌููุนูู ูููุฑุฏูุฉ ุงูุซุงููุฉ

**ุงูุฎุทูุงุช:**
1. ุงูุฐูุงุจ ุฅูู: `/shift-handovers/transfer-workers`
2. ุชุญุฏูุฏ ุงููุฑุฏูุฉ ุงูุฃููู
3. ุชุญุฏูุฏ "ุชุญุฏูุฏ ุงููู" ุฃู ุงุฎุชูุงุฑ ูู ุนุงูู ูููุฑุฏุฉ
4. ุงุฎุชูุงุฑ ุงููุฑุฏูุฉ ุงูุซุงููุฉ
5. ุชุฃููุฏ ุงูููู

**ุงููุชูุฌุฉ:**
- โ ุฌููุน ุงูุนูุงู ุงูุซูุงุซุฉ ุงูุชูููุง
- โ ุณุฌู ูุงุญุฏ ูู `shift_handovers` ููุถุญ ููู 3 ุนูุงู
- โ ุงุณุชูุฑุงุฑ ุงูุนูู ุนูู ููุณ ุงููุฑุญูุฉ ููู ูุน ูุฑูู ุฌุฏูุฏ

---

## ุงูุชูุงูู ูุน ุงูุฃูุธูุฉ ุงูุฃุฎุฑู

### ๐ ุชูุงูู ูุน `WorkerStageHistory`
- ุชุณุฌูู ุจุฏุงูุฉ ูููุงูุฉ ุนูู ุงูุนุงูู ุนูู ูู ูุฑุญูุฉ
- ุญุณุงุจ ูุฏุฉ ุงูุนูู
- ุชุชุจุน ุงููุณุงุฑ ุงููุธููู ููุนุงูู

### ๐ ุชูุงูู ูุน `ShiftAssignment`
- ุฑุจุท ุงูุนุงูู ุจุงููุฑุฏูุฉ
- ุชุชุจุน ุงููุฑุญูุฉ ุงูุญุงููุฉ
- ูุนูููุงุช ุงููุณุคูู

### ๐ ุชูุงูู ูุน `ShiftHandover`
- ุชูุซูู ูู ููู
- ูุนูููุงุช ูู/ุฅูู
- ููุงุญุธุงุช ุงูููู
- ุญุงูุฉ ุงูููุงููุฉ

---

## ุฅุฌุฑุงุกุงุช ุงูุฃูุงู ูุงูุชุญูู

### โ ุงูุชุญููุงุช ุงููุทุจูุฉ:

1. **ุงูุชุญูู ูู ุงููููุฉ:**
   - ูุฌุจ ุฃู ูููู ุงููุณุชุฎุฏู ูุณุฌู ุงูุฏุฎูู
   - ูุฌุจ ุฃู ุชููู ูุฏูู ุงูุฃุฐููุงุช ุงููุทููุจุฉ

2. **ุงูุชุญูู ูู ุงูุจูุงูุงุช:**
   - ุงูุชุญูู ูู ูุฌูุฏ ุงููุฑุฏูุงุช ุงููุญุฏุฏุฉ
   - ุงูุชุญูู ูู ูุฌูุฏ ุงููุฑุญูุฉ/ุงูุนูุงู
   - ุงูุชุญูู ูู ุนุฏู ููู ูููุณ ุงููุฑุฏูุฉ

3. **ุงูุชุญูู ูู ุงูุญุงูุฉ:**
   - ูุฌุจ ุฃู ุชููู ุงููุฑุฏูุงุช ูุดุทุฉ
   - ูุฌุจ ุฃู ูููู ุงูุนุงูู ูุดุทุงู

4. **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:**
   - ุงุณุชุฎุฏุงู ุงููุนุงููุงุช (Transactions)
   - ุงูุชุฑุงุฌุน ุงูุชููุงุฆู ุนูุฏ ุงูุฎุทุฃ
   - ุชุณุฌูู ุงูุฃุฎุทุงุก

---

## ุงูููุงุญุธุงุช ุงููุงูุฉ

โ๏ธ **ุชุญุฐูุฑุงุช:**
- ุงูููู ููุฑู ููุง ูููู ุงูุชุฑุงุฌุน ุนูู ุชููุงุฆูุงู
- ูุฌุจ ุงูุชุฃูุฏ ูู ุงูุจูุงูุงุช ูุจู ุงูุชุฃููุฏ
- ุงูููู ูุคุซุฑ ุนูู ุฌููุน ุงูุนูุงู ุงููุฑุชุจุทูู ุจุงููุฑุญูุฉ
- ูุฌุจ ุชุณุฌูู ุงูููุงุญุธุงุช ุนูุฏ ุงูููู ููุชุชุจุน

๐ก **ูุตุงุฆุญ:**
- ุงุณุชุฎุฏู ุงูููุงุญุธุงุช ูุชูุซูู ุณุจุจ ุงูููู
- ุชุญูู ูู ูุงุฆูุฉ ุงูุนูุงู ูุจู ุงูููู
- ุงุณุชุฎุฏู "ุชุญุฏูุฏ ุงููู" ุนูุฏ ููู ุฌููุน ุงูุนูุงู
- ุงุญูุธ ุงูุชูุงุฑูุฑ ุงูุฏูุฑูุฉ ููููู ูุงูุชุญูููุงุช

---

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุฑุณุงูุฉ "ูุง ุชูุฌุฏ ูุฑุฏูุฉ ูุดุทุฉ"
**ุงูุญู:**
- ุชุฃูุฏ ูู ุฃู ุงููุฑุฏูุฉ ุงูุฃููู ูุดุทุฉ (status = 'active')
- ุชุฃูุฏ ูู ุฃู ุงููุฑุญูุฉ ูุฑุชุจุทุฉ ุจุงููุฑุฏูุฉ ุจุดูู ุตุญูุญ

### ุงููุดููุฉ: ูุง ุชูุฌุฏ ุนูุงู ูููููู
**ุงูุญู:**
- ุชุฃูุฏ ูู ุฃู ููุงู ุนูุงู ูุดุทูู ูู ุงููุฑุฏูุฉ
- ุชุญูู ูู ุฌุฏูู `worker_stage_history`

### ุงููุดููุฉ: ุงูุฎุทุฃ "ุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ"
**ุงูุญู:**
- ุชุญูู ูู ููุก ุฌููุน ุงูุญููู ุงููุทููุจุฉ
- ุชุฃูุฏ ูู ุฃู ุงููุฑุฏูุงุช ุงููุฎุชุงุฑุฉ ูุฎุชููุฉ

---

## ุงูุฏุนู ูุงููุณุงุนุฏุฉ

ุฅุฐุง ูุงุฌูุช ูุดููุฉ:
1. ุชุญูู ูู ุงูุฃุฐููุงุช ุงููุทููุจุฉ
2. ุฑุงุฌุน ุณุฌูุงุช ุงูุฎุทุฃ (Logs)
3. ุชุญูู ูู ุณุฌู `shift_handovers` ูุชุชุจุน ุงูุนูููุฉ
4. ุชูุงุตู ูุน ุงููุฑูู ุงูุชููู
